/** Copyright (c) 2012 Sailthru, Inc. | Revision: 4076ffbc430fa73a62af8e8ed527ed7c9f2b03bf | Generated: Fri Feb 10 0:34:32 EST 2012 **/
(function(){var a,b=Array.prototype.indexOf||function(e){for(var d=0,c=this.length;d<c;d++){if(d in this&&this[d]===e){return d}}return -1};window.Sailthru=window.sailthru=a=(function(){var d;d=null;function c(){this.options={};this.hidden=false;this.protocol=window.location.protocol}c.setup=function(h){var f,e,g,i;if(typeof h.domain==="undefined"){return}g=c;g.tracked={};if(!(g.__instance instanceof c)){g.__instance=new this;g.__instance.options={spider:true,concierge:false,cookieDomain:window.location.host};for(f in h){e=h[f];g.__instance.options[f]=h[f]}if(typeof g.__instance.options.tags==="undefined"){g.__instance.options.tags=g.__instance.getContentTags()}if(g.__instance.options.concierge&&g.__instance.cookieIsEnabled()===true&&g.__instance.getCookie("sailthru_recommendation_hidden")!=="true"){g.__instance.options.concierge=g.__instance._conciergeDefaultOptions();if(h.concierge!==true){i=h.concierge;for(f in i){e=i[f];g.__instance.options.concierge[f]=h.concierge[f]}}g.__instance._recommendationBox()}else{if(typeof g.__instance.options.tags!=="undefined"||g.__instance.options.spider===true){g.__instance._horizonTrack()}}}return g.__instance};c.logFB=function(g){var i,h,e,f;if(g==null){g=false}if(g===false){g=window.location.href}h={};f=function(j,m){var l;if(typeof window.FB!=="undefined"){window.FB.api("/",{id:j},function(n){if(n.shares!=="undefined"){return m(n.shares)}})}else{l={url:"https://graph.facebook.com/?id="+encodeURIComponent(j),async:false,success:function(n){if(n.shares!=="undefined"){return m(n.shares)}}};$.ajax(l)}};if(window.FB){e=window.FB;i=(function(){var j;j=false;e.getLoginStatus(function(l){if(l.authResponse){if(l.authResponse.userID){j={logged_in:true,uid:l.authResponse.userID!=null}}}else{if(l.session){if(l.session.uid){j={uid:l.session.uid,logged_in:true}}}else{j=false}}});return j})();if(i!==false){h=i}}f(g,function(j){if(j!=="undefined"){h.shares=j}});return h};c.prototype.getContentTags=function(){var j,f,i,h,g,e;j=document.getElementsByTagName("meta");if(j.length>0){for(i=0,g=j.length;i<g;i++){f=j[i];if(typeof f.name!=="undefined"&&f.name.toLowerCase()==="sailthru.tags"&&typeof f.content!=="undefined"){return f.content}}for(h=0,e=j.length;h<e;h++){f=j[h];if(typeof f.name!=="undefined"&&f.name.toLowerCase()==="keywords"&&typeof f.content!=="undefined"){return f.content}}}return null};c.prototype.getCookie=function(g){var j,f,i,h,e;if(this.cookieIsEnabled()!==true){return null}i=g+"=";f=document.cookie.split(";");for(h=0,e=f.length;h<e;h++){j=f[h];while(j.charAt(0)===" "){j=j.substring(1,j.length)}if(j.indexOf(i)===0){return j.substring(i.length,j.length)}}return null};c.prototype.setCookie=function(f,g,i){var h,e;if(this.cookieIsEnabled()!==true){return false}e=new Date();e.setDate(e.getDate()+i);h=f+"="+escape(g);if(i!==null){e=new Date();e.setDate(e.getDate()+i);h+=";expires="+e.toUTCString()}h+=";path=/;domain="+this.options.cookieDomain;document.cookie=h;return true};c.prototype.cookieIsEnabled=function(){return navigator.cookieEnabled||(b.call(document,"cookie")>=0&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1))};c.prototype.tagsToString=function(f){var e;e=f instanceof Array?f.join(","):f;return e};c.recommendationTrack=function(l,g,f,h){var p,m,n,j,i,e,o;if(typeof c.tracked==="undefined"){c.tracked={}}if(c.tracked[f]){return}c.tracked[f]=true;e=window.location.protocol+"//"+l+"/horizon/recommendtrack?id="+g;if(f){e+="&event="+f}if(h){for(j in h){o=h[j];e+="&"+j+"="+encodeURIComponent(o)}}if(f==="click"){n=c.__instance;p=parseInt(n.getCookie("hcl"));p=isNaN(p)?1:p+1;n.setCookie("hcl",p)}i=parseInt(Math.random()*10000,10);e+="&cb="+i;m=new Image(1,1);m.src=e;m.onerror="";return};c.recommendationBoxCallback=function(e){return c.jq(document).trigger("SailthruDataLoaded",[e])};c.prototype.test=function(){if(typeof console!=="undefined"){console.log("this is test call")}return};c.prototype._conciergeDefaultOptions=function(){var f,e;f=this.protocol==="https:"?"d1gp8joe0evc8s.cloudfront.net":"cdn.sail-horizon.com";return e={from:"top",threshold:400,delay:null,offsetBottom:0,cssPath:this.protocol+"//"+f+"/assets/css/horizon/recommendation.css"}};c.prototype._recommendationBox=function(){var l,h,i,n,e,o,g,m,f,j;l=c.jq.extend({},this.options.concierge);e=null;h=false;l.url=this.protocol+"//"+this.options.domain+"/recommend?format=jsonp&callback=?";if(this.options.concierge.filter&&this.options.concierge.filter.tags){l.url+="&filter[tags]="+this.tagsToString(this.options.concierge.filter.tags)}if(this.options.spider!==true){l.url+="&nospider=1"}if(this.options.tags){l.url+="&tags="+encodeURIComponent(this.tagsToString(this.options.tags))}if(this.getCookie("hcl")){l.url+="&clicks="+this.getCookie("hcl")}l.domain=this.options.domain;this.data={};n=this;i=typeof this.options.delay!=="undefined"?this.options.delay:false;m=function(){var p=this;f(l.cssPath);c.jq(document).bind("SailthruDataLoaded",function(r,q){p.data=q;p.dataLoaded=true;return o()});c.jq.getJSON(l.url);c.jq(window).scroll(function(u){var t,r,s,v,q;if(p.dataLoaded===true){t=c.jq(p);s=t.scrollTop();r=c.jq(document).height()-c.jq(window).height();if(l.threshold instanceof jQuery){q=0-(l.threshold.eq(0).offset().top-c.jq(window).height());v=0}else{q=l.from==="bottom"?l.threshold:-l.threshold;v=l.from==="bottom"?r:0}if(s>=(v-q)){return j()}else{return g()}}});if(i){return e=setTimeout(function(){clearTimeout(e);return j()},i)}};f=function(q){var p;p=document.createElement("link");p.href=q;p.rel="stylesheet";p.type="text/css";p.async=true;document.getElementsByTagName("head")[0].appendChild(p)};o=function(){var r,p,t,q,s=this;q=this.data.content;r=c.jq('<div class="recommendation sailthruRecommendation" />');if(typeof q.html!=="undefined"){r.html(q.html);p=r.find("a.closeRecommendation");t=r.find("a.openRecommendation");r.appendTo("body")}p.click(function(u){u.preventDefault();n.setCookie("sailthru_recommendation_hidden","true",30);s.hidden=true;g();return false});t.click(function(u){u.preventDefault();n.setCookie("sailthru_recommendation_hidden","false",30);s.hidden=false;j();return false});setTimeout(function(){var v,w,u;v=c.jq('<iframe src="" FRAMEBORDER="0" />');w={bottom:l.offsetBottom,zIndex:"10000"};r.css(w);u={position:"fixed",width:r.outerWidth(),height:r.outerHeight(),zIndex:"9999",right:0,bottom:l.offsetBottom,display:"none"};v.css(u);if(c.jq.browser.msie){r.add(v).addClass("ie");if(c.jq.browser.version==="6.0"){r.add(v).addClass("ie6")}}if(r.is(".ie6")){r.add(v).css("position","absolute")}v.appendTo("body");s.$elem=r;return s.$iframe=v},100)};j=function(){if(!navigator.cookieEnabled){return false}if(n.getCookie("sailthru_recommendation_hidden"==="true")){return false}if(this.hidden){return false}if(this.$elem&&!$elem.is(":animated")){this.$elem.find(".openWrapper").hide();this.$iframe.show();this.$elem.show().animate({right:0},"normal")}return c.recommendationTrack(l.domain,this.data.content.id,"show",this.data.track)};g=function(){var t,p,r,q,s=this;if(this.$elem&&!this.$elem.is(":animated")){p=this.$elem.find(".openWrapper");t=p.children("a");r=(this.$elem.outerHeight()/2)-11;p.show();q=this.$elem.outerWidth()-p.outerWidth();return this.$elem.animate({right:-q},"normal",function(){return s.$iframe.hide()})}};return m()};c.prototype._horizonTrack=function(){var h,l,f,m,g,i,n,j,e;f=parseInt(Math.random()*10000,10);h=this.protocol==="https:"?"horizon.sailthru.com":this.options.domain;g=this.protocol+"//"+h+"/horizon/track?r="+f+"&url="+encodeURIComponent(document.location);if(this.protocol==="https:"){g+="&d="+this.options.domain}m=this.getCookie("sailthru_hid");if(m!==null&&this.protocol==="https:"){g+="&hid="+m}if(typeof this.options.tag!=="undefined"){this.options.tags=this.options.tag}if(this.options.tags){if(this.options.tags instanceof Array){g+="&tags="+encodeURIComponent(params.tags.join(","))}else{if(this.options.tags instanceof Object){j=params.tags;for(i=0,n=j.length;i<n;i++){e=j[i];g+="&tags["+encodeURIComponent(k)+"]="+encodeURIComponent(e)}}else{g+="&tags="+encodeURIComponent(this.options.tags)}}}if(this.options.spider){g+="&spider=1"}l=new Image(1,1);l.src=g;l.onerror="";return};return c})();if(window.$){a.jq=$}}).call(this);